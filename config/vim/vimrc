let g:mapleader=" "

source $XDG_CONFIG_HOME/vim/vimrc.options
source $XDG_CONFIG_HOME/vim/vimrc.autocmds
source $XDG_CONFIG_HOME/vim/vimrc.keymaps
source $XDG_CONFIG_HOME/vim/vimrc.tabline

syntax on

if !has('nvim') && filereadable(expand("$XDG_CONFIG_HOME/vim/vimrc.bundles"))
  source $XDG_CONFIG_HOME/vim/vimrc.bundles
endif

filetype plugin indent on

if has('persistent_undo')
  let target_path=expand('~/.vim/undo')
  if !isdirectory(target_path)
    call mkdir(target_path, "p", 0700)
  endif
  let &undodir=target_path
  set undofile
  set undolevels=10000
  set undoreload=100000
endif

augroup vimrcEx
  autocmd!

  " When editing a file, always jump to the last known cursor position.
  " Don't do it for commit messages, when the position is invalid, or when
  " inside an event handler (happens when dropping a file on gvim).
  autocmd BufReadPost *
    \ if &ft != 'gitcommit' && line("'\"") > 0 && line("'\"") <= line("$") |
    \   exe "normal g`\"" |
    \ endif
augroup END

" Quicker window movement
nnoremap <C-j> <C-w>j
nnoremap <C-k> <C-w>k
nnoremap <C-h> <C-w>h
nnoremap <C-l> <C-w>l

" Local config
if filereadable($HOME . "/.vimrc.local")
  source ~/.vimrc.local
endif

" Press <esc> to clear search highlighting
nnoremap <esc> :noh<CR>

packadd! cfilter

" Search
nnoremap <leader>/ :silent! grep! 
nnoremap <leader>? :silent! grepadd! 
augroup AutoOpenQfAfterGrepAdd
  autocmd!
  autocmd QuickFixCmdPost grep,grepadd copen
augroup END
